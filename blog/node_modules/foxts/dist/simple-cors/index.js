"use strict";var e=require("../fast-string-array-join/index.js");exports.createSimpleCors=function(s){let t,r;const n={origin:"*",allowMethods:["GET","HEAD","PUT","POST","DELETE","PATCH"],allowHeaders:[],exposeHeaders:[],...s},o=n.origin;if("string"==typeof o)t="*"===o?()=>"*":e=>o===e?e:null;else if("function"==typeof o)t=o;else{const e=new Set(o);t=s=>e.has(s)?s:null}const a=n.allowMethods;r="function"==typeof a?a:Array.isArray(a)?()=>a:()=>[];const l="*"!==o;return async function(s,o){let a=t(s.headers.get("Origin")||"");if(a&&"object"==typeof a&&"then"in a&&(a=await a),a&&o.headers.set("Access-Control-Allow-Origin",a),l){const e=s.headers.get("Vary");e?o.headers.set("Vary",e):o.headers.set("Vary","Origin")}n.credentials&&o.headers.set("Access-Control-Allow-Credentials","true"),n.exposeHeaders?.length&&o.headers.set("Access-Control-Expose-Headers",e.fastStringArrayJoin(n.exposeHeaders,","));let i=r(s.headers.get("origin")||"");if("then"in i&&(i=await i),i.length&&o.headers.set("Access-Control-Allow-Methods",e.fastStringArrayJoin(i,",")),"OPTIONS"===s.method){null!=n.maxAge&&o.headers.set("Access-Control-Max-Age",n.maxAge.toString());let t=n.allowHeaders;if(!t?.length){const e=s.headers.get("Access-Control-Request-Headers");e&&(t=e.split(/\s*,\s*/))}t?.length&&(o.headers.set("Access-Control-Allow-Headers",e.fastStringArrayJoin(t,",")),o.headers.append("Vary","Access-Control-Request-Headers"))}return o}};